apiVersion: batch/v1
kind: Job
metadata:
  name: django-postgre-migrations
spec:
  template:
    spec:
      imagePullSecrets:
        - name: artifact-registry
      containers:
        - name: django-job-container
          image: us-east1-docker.pkg.dev/personal-project-429201/my-repo/studyroom:fd5d7f2a
          imagePullPolicy: IfNotPresent
          command: ["python", "/app/manage.py", "migrate"]
          env:
            - name: DB_USER
              value: "ajay"
              # valueFrom:
              #   secretKeyRef:
              #     name: postgres-credentials
              #     key: user
            - name: DB_USER_PASSWORD
              value: "0745"
              # valueFrom:
              #   secretKeyRef:
              #     name: postgres-credentials
              #     key: password
            - name: DB_NAME
              value: "studyroom"
              # valueFrom:
              #   configMapKeyRef:
              #     name: app-variables
              #     key: DB_NAME
            - name: DB_HOST
              value: "postgres-service.developement.svc.cluster.local"
              # valueFrom:
              #   configMapKeyRef:
              #     name: app-variables
              #     key: DB_HOST
            - name: DB_DB_PORT
              value: "5432"
              # valueFrom:
              #   configMapKeyRef:
              #     name: app-variables
              #     key: DB_PORT

      restartPolicy: Never
